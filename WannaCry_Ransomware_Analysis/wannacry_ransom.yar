rule RANSOMWARE_WANNAHUSKY {
	meta:

		author = "Aniksha Shetty"
		description = "Detect malicious ransomware sample, from wannahusky family"
        created = "05-19-2024"
	strings:
		$target_file = "@Desktop\\cosmo.jpeg" ascii
        $background_file = "\\WANNAHUSKY.PNG" ascii
        $powershell = "@Desktop\\ps1.ps1" ascii
        $encrypted_file = "@Desktop\\cosmo.WANNAHUSKY"
		$base_64 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/" ascii
		$compile_lang = "@nim" ascii
        $crypt_api = "bCryptGenRandom" ascii
		$pe_magic_byte = "MZ"
	
	condition:
		$pe_magic_byte at 0 and $compile_lang and $crypt_api and
		($background_file or $powershell) or
		($target_file and $base_64 and $encrypted_file)

}